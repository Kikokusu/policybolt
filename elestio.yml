config:
  # ───── Runtime / framework ─────
  runTime:    'NodeJs'
  version:    '20'          # current LTS, satisfies Vite ≥5
  framework:  'React'

  # ───── CI steps ─────
  installCommand: 'npm ci'            # deterministic install
  buildCommand:   'npm run build'     # vite build → dist/
  buildDir:       'dist'

  # Bind to all interfaces and honour $PORT when Elestio injects it
  runCommand: 'PORT=${PORT:-4173} npm run preview -- --port ${PORT:-4173} --host 0.0.0.0'

  # ───── Optional dashboard metadata ─────
  icon:       'src/assets/logo.svg'
  screenshot: 'docs/screenshot.png'

ports:
  - protocol:        'HTTPS'
    targetProtocol:  'HTTP'
    listeningPort:   '443'            # public TLS port
    targetPort:      '4173'           # internal Vite preview port
    targetIP:        '0.0.0.0'        # listen on all interfaces
    public:          true
    path: '/'
    isAuth:          false

environments:                        # keep secrets out of VCS
  - key:   'NODE_ENV'
    value: 'production'
  # - key: 'VITE_SUPABASE_URL'
  #   value: '${{ vault.VITE_SUPABASE_URL }}'
